<!-- markdownlint-enable -->
# NDX-DN01 - NEO Developer Experience

- Author: Harry Pierson (harrypierson@ngd.neo.org)
- Status: Draft

## Abstract

This design note describes the goals and guiding principles of a world-class
experience for developers targeting the NEO platform. This note is intended to
be high level and aspirational. Further design notes will specify in detail how
individual capabilities will be implemented.

Note, design notes related to the NEO Developer Experience will be prefixed with
"NDX". For example, this design note is designated "NDX-DN01" to indicate "NEO
Developer Experience Design Note #1".

## Overview

> "Make the impossible possible, the possible easy, the easy elegant." - Mosh√© Feldenkrais

Broad adoption is critical for the NEO platform to deliver on the
[Smart Economy vision](https://docs.neo.org/en-us/whitepaper.html#neo-design-goals-smart-economy)
outlined in the [NEO white paper](https://docs.neo.org/en-us/whitepaper.html).
As the tech industry has seen play out many times, developers are critical to platform
adoption.

Developers desire two - somewhat contradictory - things: Capability and Simplicity.

Capability in this context means the raw capabilities of the underlying NEO platform.
Today, NEO provides capabilities for the decentralized management of programmable
digital assets via blockchain and smart contract technology. These capabilities
provide a trusted, intermediary-free technology solution for problems that have
traditionally required a trusted central authority to solve. Further capabilities
for the NEO platform include digital identity, decentralized file/data storage and
a blockchain oracle for access to data from outside the blockchain. Generally
speaking, the more capabilities provided by the core NEO platform, the more
powerful solutions developers can build.

On the other hand, developers want their jobs to be easy and the tools they use
to be simple. They want to be able to focus on the solution they are building, not
learning the platform they are building their solution on. Several of NEO's
technology choices are intended to simplify the experience for developers building
on the NEO platform. For example, by providing libraries and Smart Contract
compilers for multiple languages (C#, Java, Python and JavaScript to name a few),
the NEO platform enables developers to build Smart Contracts using a language
they already know instead of forcing them to learn something new.

While improving the core NEO platform capability is a critical task, this design
note and others that follow in the NDX series are focused on delivering a world-class
developer experience for the core NEO platform. As such, they will be primarily
focused on simplifying a Smart Economy developer's life rather than detailing new
capabilities of the core NEO platform itself.

## Developing for the Smart Economy

In order to specify the tools needed to provide a world-class developer experience,
it is first necessary to understand the architecture of a typical Smart Economy solution.
While Smart Economy is a large solution space with many possible technology approaches,
several key elements of architecture appear to be common across most solutions.

Programmable management of digital assets is a critical enabling feature of the
Smart Economy. The NEO white paper identifies blockchain technology with digital
identity and smart contracts as the critical platform pieces that the NEO platform
provides for Smart Economy applications.

### Blockchain Decentralized Application Architecture

At it's core, a blockchain is an open, decentralized, cryptographically secure
ledger of transactions. The blockchain runs on a disparate set of machines,
generating ledger entries known as "blocks" that are open for all to inspect and
are impossible to forge.

Nodes in the blockchain topology communicate using a full-duplex, peer-to-peer
[network protocol](https://docs.neo.org/en-us/network/network-protocol.html)
running on top of TCP and/or WebSockets. This protocol drives the
[consensus algorithm](https://docs.neo.org/en-us/basic/consensus/whitepaper.html)
used to generate new blocks as well as to synchronize data between nodes in the
blockchain.

Nodes using the peer-to-peer protocol typically establish long-lived connections
to multiple other nodes in the network. These long-lived connections allow for
efficient communication between consensus nodes and they enable notifications
about changes to the system - for example, the creation of a new block - to be
broadcast across the entire network.

Nodes using this peer-to-peer protocol typically have a full copy of the
blockchain ledger locally. The data generated by the blockchain is non-trivial.
As of July 7th, 2019, the [MainNet offline synchronization package](https://sync.ngd.network/)
is 5.36 gigabytes. The size of this data will continue to grow, with the growth
accelerating as NEO grows in popularity.

Between the connection-oriented network protocol and the need to store gigabytes
of blockchain data, it's reasonable to expect that most nodes in the blockchain
network would be dedicated, always-on, always-connected server class machines.
This implies that the blockchain must provide a mechanism for devices that are not
a part of blockchain network to interact with the blockchain without being always
connected or having a fully synchronized copy of the blockchain data.

The NEO blockchain provides such a mechanism. In addition to the connected,
full-duplex protocol used for intra-node communication, the NEO blockchain
provides a stateless, request-response
[remote API interface](https://docs.neo.org/en-us/node/cli/latest-version/api.html)
for accessing blockchain data and invoking deployed smart contracts from devices
that aren't a part of the blockchain network. This interface uses
[JSON-RPC](https://www.jsonrpc.org/specification) running on top of HTTP.

Other blockchain ecosystems refer to devices accessing the network via a
remote API as "lite" nodes while devices in the blockchain network are "full"
nodes. However, this terminology is be somewhat confusing in the NEO ecosystem.
The [NEO Consensus white paper](https://docs.neo.org/en-us/basic/consensus/whitepaper.html)
divides so called "full" nodes between "ordinary" nodes and "consensus" nodes
(also in places called "bookkeeping" nodes). As such, this document proposes a
slightly different taxonomy:

- Code running on devices that is accessing the block chain network via the
  remote API JSON-RPC interface will be referred to in this document as **off-chain**.
- Code running on devices that are connected to the block chain network via the
  connected, full-duplex protocol and have a full copy of the block chain data
  will be referred to in this document as **on-chain**.
  - Note, consensus nodes are considered part of the core blockchain infrastructure
    as they cannot be added to the NEO blockchain network independently. As such,
    consensus nodes do not run application specific code and are excluded from
    this taxonomy.
- Code running on block chain nodes as part of smart contracts will be referred
  to in this document as **in-chain**.

Decentralized blockchain applications typically have application code running in
at least two different locations. For example, a blockchain token would have
wallet code running on off-chain devices as well as smart contracts running
in-chain to manage the flow of tokens between users.

## Developer Scenarios

Note, as per this design note's abstract, details for each of the following
sections will be fleshed out in separate design notes. These sections are
intentionally high level and aspirational.

### Work With Existing Development Language Ecosystems

As per the official white paper, NEO is designed to integrate into existing
development language ecosystems. The goal of this approach is to enable developers
to build Smart Economy solutions while learning a minimum of new tools and languages.

In order for a given development language ecosystem to target the NEO blockchain
platform, a set of libraries, frameworks and tools need to be developed specific
to that ecosystem.

- For **off-chain** development, developers need libraries to securely manage
  user wallets and to invoke remote API functions. Most mainstream languages
  provide the core crypto and network capabilities needed to build these libraries.
- For **on-chain** development, developers needs a framework that provides
  an implementation of the peer-to-peer network protocol as well as many of the
  core types such as block and transaction.
  - Note, this does not need to be a full consensus node implementation. An
    extensible framework for building on-chain nodes is likely to be more useful
    to developers than a consensus node implementation.
- For **in-chain** development, developers need a compiler than can convert
  smart contracts written in their language of choice to NeoVM byte code.
  Additionally they need reference libraries for NeoVM capabilities for
  developers to code and compile against. Developers also need tools for
  testing and debugging their smart contracts.
  
Ideally, the development model for each aspect of the blockchain application
architecture would be designed to work together as a whole, rather than as a
set of loosely related frameworks and tools. In particular, developers should
be able to move between different aspects without having to change their
development approach. For example, the APIs for invoking a smart contract
should be similar (if not identical) in off-chain libraries, on-chain
frameworks and in-chain reference libraries. The underlying implementation of
these APIs will vary, but the public surface area should feel the same.

### Make It Easy To Get Started

It must be easy for developers to acquire the tools and libraries they need
to build solutions on the NEO platform.

These days, most language ecosystems use a package management system for
distribution of tools and libraries. For example, [NuGet](https://www.nuget.org/)
is the package manager for .NET libraries, but it is also used for distributing
[custom templates](https://docs.microsoft.com/en-us/dotnet/core/tools/custom-templates)
as well as [global tools](https://docs.microsoft.com/en-us/dotnet/core/tools/global-tools).
Likewise, [npx](https://www.npmjs.com/package/npx) can execute scripts directly
from the [NPM](https://www.npmjs.com/) package repository and
[templates](https://www.npmjs.com/search?q=keywords:yeoman-generator) for the
[Yeoman](https://yeoman.io/) scaffolding tool are distributed via NPM.

Additionally, tools like Visual Studio Code and online services like GitHub are
extensible and work across multiple developer language ecosystems. Marketplaces
for [Visual Studio Code](https://marketplace.visualstudio.com/vscode) and
[GitHub](https://github.com/marketplace) provide a developer-friendly mechanism
for distributing custom extensions to these tools and services.

NEO's developer libraries and tools should be distributed using the existing
package management and tool marketplace options available for a given
development language ecosystem.

As an example, all of the libraries and most of the tools for .NET NEO development
should be distributed via NuGet. This includes the various libraries for on/off/in
chain development, custom templates for new NEO projects, the NEON compiler that
compiles managed DLLs to NeoVM byte code and the NEO Express development
blockchain (described in the next section). Extensions to existing developer IDEs
such as Visual Studio and Visual Studio Code would be distributed via their
respective marketplaces. A single "get started" web page would provide all links
for installing these various components.

### A Blockchain Optimized Development and Testing

Today, NEO provides two official client applications for blockchain network
nodes: neo-cli and neo-gui. These clients can connect MainNet, TestNet or can
be used to run a private blockchain instance. These clients are used to
run consensus nodes and by real end users to transfer assets on the
MainNet. As such, neo-cli and neo-gui must be optimized for security and other
production usage scenarios.

NEO Express is a new NEO blockchain client application, optimized for development
scenarios. It will be built on the same NEO platform core as neo-cli and
neo-gui are, ensuring that developer's code will run the same on MainNet
as it does in their development environment. NEO Express will run on the
developer's local machine, using as few resources as needed to host the
blockchain instance.

NEO Express will have support for a variety of developer-only scenarios.

- Simple privatenet instance creation
- Password-free wallet and asset management (including genesis NEO)
- Simple smart contract deployment and invocation
- Blockchain fast-forward (for GAS creation) and rollback (for testing purposes)
- Blockchain import/export (for test and collaboration purposes)
- Privatenet instance management and blockchain explorer integrated into Visual
  Studio Code

### Smart Contract Debugging and Testing

Mitch Denny [describes](https://mitchdenny.com/the-inner-loop/) the "inner loop"
as "the iterative process that a developer performs when they write, build and
debug code". These steps are typically performed in some type of integrated
development environment (aka IDE) like Visual Studio Code. The IDE provides a
source editing experience - often enhanced with auto complete and refactoring
services specific to the development language in use. Build tools - such as
Microsoft's C# compiler and NEO's NEON compiler - are typically command line
applications, but the IDE provide a mechanism to launch these tools from the
user interface. That leaves debugging (and testing) as the final aspect of the
inner loop that needs to be addressed for NEO developers.

The NEO smart contract debugger will implement Microsoft's
[Debug Adapter Protocol](https://microsoft.github.io/debug-adapter-protocol/),
enabling it to be easily integrated into a variety of existing IDEs, including
Visual Studio and Visual Studio Code. As NEO supports building smart contracts
in a variety of languages, the NEO Debug Adapter will need to be extensible in
order for it to support a variety of smart contract languages.

In order to provide test and debug repeatability, developers need the ability to
manage the blockchain state precisely. As stated in a previous section, NEO
Express will support developer scenarios related to state management such as roll
back and import/export. Additionally, the NEO smart contract debugger will support
an isolated mode where the blockchain related services such as transaction
access and contract storage will be emulated. This isolated NeoVM instance will
work with both with the smart contract debugger as well as the NEO test
infrastructure.

### Manage the Blockchain Application Life Cycle

Modern application development - blockchain or otherwise - has increasingly
adopted a more operational practice. Typically, a "DevOps" based life cycle
this starts with automated build and deployment of application assets and flows
through to telemetry collection that drives future development decisions.

Examples of DevOps capabilities needed for NEO blockchain applications:

- Continuous Integration/Delivery of NEO smart contracts
- Application Performance Management for NEO blockchain applications across all
  three taxonomy aspects (on/off/in chain)
- Decentralized application logging and telemetry

### Developer Guidance and Sample Blockchain Applications

TBD.
